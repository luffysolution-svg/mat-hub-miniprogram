var formatNumber = function(num, decimals) {
  if (num === null || num === undefined) {
    return '--'
  }
  if (decimals === undefined) {
    decimals = 4
  }
  var n = parseFloat(num)
  if (n !== n) {
    return '--'
  }
  if (n === Math.floor(n)) {
    return '' + n
  }
  var factor = Math.pow(10, decimals)
  var rounded = Math.round(n * factor) / factor
  return '' + rounded
}

var formatSci = function(num, decimals) {
  if (num === null || num === undefined) {
    return '--'
  }
  if (decimals === undefined) {
    decimals = 2
  }
  var n = parseFloat(num)
  if (n !== n) {
    return '--'
  }
  var abs = Math.abs(n)
  if (abs !== 0 && (abs < 0.001 || abs >= 10000)) {
    return n.toExponential(decimals)
  }
  return formatNumber(n, decimals)
}

// 数组转字符串，用分隔符连接
var join = function(arr, separator) {
  if (!arr || arr.length === 0) {
    return ''
  }
  if (separator === undefined) {
    separator = ','
  }
  var result = ''
  for (var i = 0; i < arr.length; i++) {
    if (i > 0) {
      result = result + separator
    }
    result = result + (arr[i] || '')
  }
  return result
}

// 数组切片
var slice = function(arr, start, end) {
  if (!arr || arr.length === 0) {
    return []
  }
  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = arr.length
  }
  var result = []
  for (var i = start; i < end && i < arr.length; i++) {
    result.push(arr[i])
  }
  return result
}

// 数组切片后连接
var sliceJoin = function(arr, start, end, separator) {
  var sliced = slice(arr, start, end)
  return join(sliced, separator)
}

module.exports = {
  formatNumber: formatNumber,
  formatSci: formatSci,
  join: join,
  slice: slice,
  sliceJoin: sliceJoin
}
