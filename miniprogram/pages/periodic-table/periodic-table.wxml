<view class="container">
  <!-- æœç´¢å’Œç­›é€‰åŒºåŸŸ -->
  <view class="search-section">
    <view class="search-box">
      <input
        class="search-input"
        type="text"
        placeholder="æœç´¢å…ƒç´ åç§°ã€ç¬¦å·æˆ–åŸå­åºæ•°"
        value="{{searchQuery}}"
        bindinput="onSearch"
      />
      <view class="search-icon" wx:if="{{!searchQuery}}">ğŸ”</view>
      <view class="clear-icon" wx:if="{{searchQuery}}" bindtap="clearSearch">âœ•</view>
    </view>
  </view>

  <!-- åˆ†ç±»ç­›é€‰ -->
  <scroll-view class="category-scroll" scroll-x>
    <view class="category-list">
      <view
        class="category-item {{selectedCategory === item.id ? 'active' : ''}}"
        wx:for="{{categories}}"
        wx:key="id"
        data-category="{{item.id}}"
        bindtap="filterByCategory"
        style="border-color: {{item.color}}"
      >
        <text class="category-name">{{item.name}}</text>
      </view>
    </view>
  </scroll-view>

  <!-- å…ƒç´ åˆ—è¡¨ï¼ˆæœç´¢/ç­›é€‰æ—¶æ˜¾ç¤ºï¼‰ -->
  <scroll-view class="element-list" wx:if="{{searchQuery || selectedCategory !== 'all'}}" scroll-y>
    <view
      class="element-card"
      wx:for="{{filteredElements}}"
      wx:key="atomicNumber"
      data-number="{{item.atomicNumber}}"
      bindtap="showElementDetail"
      style="background: linear-gradient(135deg, {{categoryColors[item.category]}}15, {{categoryColors[item.category]}}35); border-left-color: {{categoryColors[item.category]}}"
    >
      <view class="element-number">{{item.atomicNumber}}</view>
      <view class="element-symbol">{{item.symbol}}</view>
      <view class="element-name">{{item.name}}</view>
      <view class="element-mass">{{item.atomicMass}}</view>
    </view>
  </scroll-view>

  <!-- å®Œæ•´å‘¨æœŸè¡¨ï¼ˆé»˜è®¤æ˜¾ç¤ºï¼‰ -->
  <scroll-view class="periodic-table-wrapper" wx:if="{{!searchQuery && selectedCategory === 'all'}}" scroll-y>
    <view class="periodic-table">
      <!-- ä¸»å‘¨æœŸè¡¨ -->
      <view class="main-table">
        <view
          class="element-cell"
          wx:for="{{mainTable}}"
          wx:key="atomicNumber"
          data-number="{{item.atomicNumber}}"
          bindtap="showElementDetail"
          style="background-color: {{categoryColors[item.category]}}; grid-row: {{item.period}}; grid-column: {{item.group}}"
        >
          <text class="cell-number">{{item.atomicNumber}}</text>
          <text class="cell-symbol">{{item.symbol}}</text>
          <text class="cell-name">{{item.name}}</text>
        </view>
      </view>

      <!-- é•§ç³» -->
      <view class="lanthanide-series" wx:if="{{lanthanides.length > 0}}">
        <text class="series-label">é•§ç³»</text>
        <view class="series-elements">
          <view
            class="element-cell small"
            wx:for="{{lanthanides}}"
            wx:key="atomicNumber"
            data-number="{{item.atomicNumber}}"
            bindtap="showElementDetail"
            style="background-color: {{categoryColors[item.category]}}"
          >
            <text class="cell-number">{{item.atomicNumber}}</text>
            <text class="cell-symbol">{{item.symbol}}</text>
          </view>
        </view>
      </view>

      <!-- é”•ç³» -->
      <view class="actinide-series" wx:if="{{actinides.length > 0}}">
        <text class="series-label">é”•ç³»</text>
        <view class="series-elements">
          <view
            class="element-cell small"
            wx:for="{{actinides}}"
            wx:key="atomicNumber"
            data-number="{{item.atomicNumber}}"
            bindtap="showElementDetail"
            style="background-color: {{categoryColors[item.category]}}"
          >
            <text class="cell-number">{{item.atomicNumber}}</text>
            <text class="cell-symbol">{{item.symbol}}</text>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- å…ƒç´ è¯¦æƒ…å¼¹çª— -->
  <view class="modal-mask" wx:if="{{showModal}}" bindtap="closeModal">
    <view class="modal-content" catchtap="{{}}">
      <view class="modal-header" style="background: linear-gradient(135deg, {{categoryColors[selectedElement.category]}}, {{categoryColors[selectedElement.category]}}CC)">
        <view class="modal-number">{{selectedElement.atomicNumber}}</view>
        <view class="modal-symbol">{{selectedElement.symbol}}</view>
        <view class="modal-name">
          <text class="name-cn">{{selectedElement.name}}</text>
          <text class="name-en">{{selectedElement.nameEn}}</text>
        </view>
        <view class="close-btn" bindtap="closeModal">âœ•</view>
      </view>

      <scroll-view class="modal-body" scroll-y>
        <view class="info-section">
          <view class="info-title">åŸºæœ¬ä¿¡æ¯</view>
          <view class="info-grid">
            <view class="info-item">
              <text class="info-label">åŸå­åºæ•°</text>
              <text class="info-value">{{selectedElement.atomicNumber}}</text>
            </view>
            <view class="info-item">
              <text class="info-label">ç›¸å¯¹åŸå­è´¨é‡</text>
              <text class="info-value">{{selectedElement.atomicMass}}</text>
            </view>
            <view class="info-item">
              <text class="info-label">å‘¨æœŸ</text>
              <text class="info-value">ç¬¬{{selectedElement.period}}å‘¨æœŸ</text>
            </view>
            <view class="info-item">
              <text class="info-label">æ—</text>
              <text class="info-value">ç¬¬{{selectedElement.group}}æ—</text>
            </view>
          </view>
        </view>

        <view class="info-section">
          <view class="info-title">ç‰©ç†æ€§è´¨</view>
          <view class="info-grid">
            <view class="info-item">
              <text class="info-label">ç†”ç‚¹</text>
              <text class="info-value">{{selectedElement.meltingPoint}} K</text>
            </view>
            <view class="info-item">
              <text class="info-label">æ²¸ç‚¹</text>
              <text class="info-value">{{selectedElement.boilingPoint}} K</text>
            </view>
            <view class="info-item">
              <text class="info-label">å¯†åº¦</text>
              <text class="info-value">{{selectedElement.density}} g/cmÂ³</text>
            </view>
            <view class="info-item" wx:if="{{selectedElement.electronegativity}}">
              <text class="info-label">ç”µè´Ÿæ€§</text>
              <text class="info-value">{{selectedElement.electronegativity}}</text>
            </view>
          </view>
        </view>

        <view class="info-section">
          <view class="info-title">ç”µå­æ„å‹</view>
          <view class="electron-config">
            <text>{{selectedElement.electronConfig}}</text>
          </view>
        </view>

        <view class="info-section" wx:if="{{selectedElement.discoveryYear}}">
          <view class="info-title">å‘ç°å¹´ä»½</view>
          <view class="discovery-year">
            <text>{{selectedElement.discoveryYear}}</text>
          </view>
        </view>
      </scroll-view>

      <view class="modal-footer">
        <button class="action-btn" bindtap="toggleFavorite">
          {{isFavorite() ? 'å–æ¶ˆæ”¶è—' : 'æ”¶è—å…ƒç´ '}}
        </button>
      </view>
    </view>
  </view>
</view>
