<view class="container">
  <!-- TabхИЗцНв -->
  <view class="tab-bar">
    <view
      class="tab-item {{activeTab === 'feeds' ? 'active' : ''}}"
      data-tab="feeds"
      bindtap="switchTab"
    >
      <text class="tab-label">цЦЗчМохКицАБ</text>
    </view>
    <view
      class="tab-item {{activeTab === 'subscriptions' ? 'active' : ''}}"
      data-tab="subscriptions"
      bindtap="switchTab"
    >
      <text class="tab-label">шовщШЕчобчРЖ</text>
    </view>
  </view>

  <!-- цЦЗчМохКицАБ -->
  <scroll-view class="content" scroll-y wx:if="{{activeTab === 'feeds'}}">
    <!-- цЧашовщШЕцПРчд║ -->
    <view class="empty-state" wx:if="{{subscriptions.length === 0}}">
      <text class="empty-icon">ЁЯУЪ</text>
      <text class="empty-text">ш┐Шц▓бцЬЙшовщШЕ</text>
      <text class="empty-hint">чВ╣хЗ╗ф╕ЛцЦ╣"шовщШЕчобчРЖ"ц╖╗хКахЕ│щФошпН</text>
      <button class="empty-btn" bindtap="switchTab" data-tab="subscriptions">
        хО╗ц╖╗хКашовщШЕ
      </button>
    </view>

    <!-- цЦЗчМохИЧшби -->
    <view class="paper-list" wx:if="{{subscriptions.length > 0}}">
      <!-- хИ╖цЦ░цМЙщТо -->
      <view class="refresh-bar">
        <button class="refresh-btn" bindtap="onRefresh" loading="{{loading}}">
          {{loading ? 'хКаш╜╜ф╕н...' : 'хИ╖цЦ░цЦЗчМо'}}
        </button>
        <text class="paper-count">хЕ▒ {{papers.length}} чпЗ</text>
      </view>

      <!-- цЦЗчМохНбчЙЗ -->
      <view
        class="paper-card"
        wx:for="{{papers}}"
        wx:key="id"
      >
        <view class="paper-header">
          <view class="paper-category">{{item.category}}</view>
          <view class="paper-date">{{item.publishDate}}</view>
        </view>

        <view class="paper-title">{{item.title}}</view>

        <view class="paper-authors">
          <text wx:for="{{item.authors}}" wx:key="*this" wx:for-item="author">
            {{author}}{{index < item.authors.length - 1 ? ', ' : ''}}
          </text>
        </view>

        <view class="paper-abstract">{{item.abstract}}</view>

        <view class="paper-keywords">
          <text
            class="keyword-tag"
            wx:for="{{item.keywords}}"
            wx:key="*this"
            wx:for-item="keyword"
          >
            #{{keyword}}
          </text>
        </view>

        <view class="paper-actions">
          <view class="action-btn" data-id="{{item.id}}" bindtap="viewPaper">
            <text class="action-icon">ЁЯФЧ</text>
            <text class="action-text">цЯечЬЛхОЯцЦЗ</text>
          </view>
          <view class="action-btn" data-id="{{item.id}}" bindtap="favoritePaper">
            <text class="action-icon">{{isFavorite(item.id) ? 'тЭдя╕П' : 'ЁЯдН'}}</text>
            <text class="action-text">{{isFavorite(item.id) ? 'х╖▓цФ╢шЧП' : 'цФ╢шЧП'}}</text>
          </view>
        </view>
      </view>

      <!-- хКаш╜╜цПРчд║ -->
      <view class="loading-tip" wx:if="{{papers.length === 0 && !loading}}">
        цЪВцЧацЦЗчМоцХ░цНо
      </view>
    </view>
  </scroll-view>

  <!-- шовщШЕчобчРЖ -->
  <scroll-view class="content" scroll-y wx:if="{{activeTab === 'subscriptions'}}">
    <view class="subscription-section">
      <!-- ц╖╗хКацМЙщТо -->
      <button class="add-sub-btn" bindtap="showAddSubscription">
        <text class="btn-icon">+</text>
        <text class="btn-text">ц╖╗хКашовщШЕ</text>
      </button>

      <!-- шовщШЕхИЧшби -->
      <view class="subscription-list">
        <view
          class="subscription-card"
          wx:for="{{subscriptions}}"
          wx:key="id"
        >
          <view class="sub-header">
            <view class="sub-keyword">{{item.keyword}}</view>
            <switch
              class="sub-switch"
              checked="{{item.enabled}}"
              data-id="{{item.id}}"
              bindchange="toggleSubscription"
            />
          </view>

          <view class="sub-info">
            <text class="sub-category">хИЖч▒╗: {{item.category}}</text>
          </view>

          <view class="sub-actions">
            <button
              class="delete-btn"
              data-id="{{item.id}}"
              bindtap="deleteSubscription"
            >
              хИащЩд
            </button>
          </view>
        </view>

        <!-- чй║чК╢цАБ -->
        <view class="empty-subs" wx:if="{{subscriptions.length === 0}}">
          <text class="empty-text">ш┐Шц▓бцЬЙшовщШЕ</text>
          <text class="empty-hint">чВ╣хЗ╗ф╕КцЦ╣цМЙщТоц╖╗хКашовщШЕ</text>
        </view>
      </view>

      <!-- шп┤цШО -->
      <view class="info-section">
        <view class="info-title">ф╜┐чФишп┤цШО</view>
        <view class="info-content">
          <text class="info-text">1. ц╖╗хКацДЯхЕ┤ш╢гчЪДхЕ│щФошпНхТМхИЖч▒╗</text>
          <text class="info-text">2. ч│╗ч╗Яф╝ЪхоЪцЬЯшО╖хПЦчЫ╕хЕ│цЦЗчМо</text>
          <text class="info-text">3. хПпщЪПцЧ╢х╝АхЕ│цИЦхИащЩдшовщШЕ</text>
          <text class="info-text">4. цФпцМБцФ╢шЧПхЦЬцмвчЪДцЦЗчМо</text>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- ц╖╗хКашовщШЕх╝╣чкЧ -->
  <view class="modal-mask" wx:if="{{showAddModal}}" bindtap="closeModal">
    <view class="modal-content" catchtap="{{}}">
      <view class="modal-header">
        <text class="modal-title">ц╖╗хКашовщШЕ</text>
        <view class="close-btn" bindtap="closeModal">тЬХ</view>
      </view>

      <view class="modal-body">
        <view class="form-group">
          <text class="form-label">хЕ│щФошпН</text>
          <input
            class="form-input"
            type="text"
            placeholder="ф╛ЛхжВ: ш╢Ехп╝уАБчЯ│хвичГп"
            value="{{newSubscription.keyword}}"
            bindinput="onKeywordInput"
          />
        </view>

        <view class="form-group">
          <text class="form-label">хИЖч▒╗</text>
          <picker
            class="form-picker"
            mode="selector"
            range="{{categories}}"
            range-key="name"
            bindchange="onCategoryChange"
          >
            <view class="picker-view">
              <text>{{categories[0].name}}</text>
              <text class="picker-arrow">тА║</text>
            </view>
          </picker>
        </view>
      </view>

      <view class="modal-footer">
        <button class="modal-btn cancel" bindtap="closeModal">хПЦц╢И</button>
        <button class="modal-btn confirm" bindtap="addSubscription">чбохоЪ</button>
      </view>
    </view>
  </view>
</view>
